{"ast":null,"code":"import _classCallCheck from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/src/App.js\";\nimport React, { Component } from 'react';\nimport uuidv4 from 'uuid/v4';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport './App.css';\nimport Nav from './Components/Nav';\nimport Task from './Components/Task';\nimport Input from './Components/Input';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.handleChecked = function (id) {\n      var updatedTasks = _this.state.tasks.map(function (todo) {\n        if (todo.id === id) {\n          todo.completed = !todo.completed;\n        }\n\n        return todo;\n      });\n\n      _this.setState({\n        task: updatedTasks\n      });\n    };\n\n    _this.handleAddTask = function (task) {\n      var token = localStorage.getItem('jwtToken');\n      var newTask = {\n        todo: task,\n        completed: false,\n        id: token._id\n      };\n      var axiosConfig = {\n        headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\"\n        }\n      };\n      axios.post('http://localhost:3001/todo/createtodo', newTask, axiosConfig).then(function (result) {\n        console.log(result);\n        var currentTaskObj = Object.assign([], _this.state.tasks);\n        currentTaskObj.push(newTask);\n\n        _this.setState({\n          tasks: result\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    _this.handleUpdateEdit = function (id, updatedTask) {\n      var updated = Object.assign([], _this.state.tasks);\n      updated.map(function (task) {\n        return task.id === id ? task.todo = updatedTask : task;\n      });\n\n      _this.setState({\n        tasks: updated\n      });\n    };\n\n    _this.handleDelete = function (id) {\n      var updated = Object.assign([], _this.state.tasks);\n      var updatedList = updated.filter(function (task) {\n        return task.id !== id;\n      });\n\n      _this.setState({\n        tasks: updatedList\n      });\n    };\n\n    _this.handleGetData = function () {\n      axios.get('http://localhost:3001/users/current').then(function (result) {\n        console.log(result);\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.handleSignUpAndSignIn = function (data) {\n      var axiosConfig = {\n        headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\"\n        }\n      };\n      axios.post('http://localhost:3001/users/register-login', data, axiosConfig).then(function (result) {\n        var token = result.data.token;\n        axios.defaults.headers.common['Authorization'] = token; // Set token to ls\n\n        localStorage.setItem('jwtToken', token); // Set token to Auth header\n        // Decode token to get user data\n\n        var decoded = jwt_decode(token);\n\n        _this.setState({\n          user: decoded.email\n        }, function () {\n          _this.handleGetData();\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.logout = function () {\n      delete axios.defaults.headers.common['Authorization'];\n      localStorage.removeItem('jwtToken');\n\n      _this.setState({\n        user: null\n      });\n    };\n\n    _this.state = {\n      tasks: [],\n      user: null\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var token = localStorage.getItem('jwtToken');\n\n      if (token) {\n        var currentTime = Date.now() / 1000;\n        var decoded = jwt_decode(token);\n\n        if (decoded.exp < currentTime) {\n          localStorage.removeItem('jwtToken');\n          this.setState({\n            user: null\n          });\n        }\n\n        axios.defaults.headers.common['Authorization'] = token;\n        this.setState({\n          user: decoded.email\n        }, function () {\n          _this2.handleGetData();\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(Nav, {\n        handleSignUpAndSignIn: this.handleSignUpAndSignIn,\n        user: this.state.user,\n        logout: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }), React.createElement(Input, {\n        handleAddTask: this.handleAddTask,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }), React.createElement(Task, Object.assign({}, this.state, {\n        handleChecked: this.handleChecked,\n        handleUpdateEdit: this.handleUpdateEdit,\n        handleDelete: this.handleDelete,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/src/App.js"],"names":["React","Component","uuidv4","axios","jwt_decode","Nav","Task","Input","App","props","handleChecked","id","updatedTasks","state","tasks","map","todo","completed","setState","task","handleAddTask","token","localStorage","getItem","newTask","_id","axiosConfig","headers","post","then","result","console","log","currentTaskObj","Object","assign","push","catch","error","handleUpdateEdit","updatedTask","updated","handleDelete","updatedList","filter","handleGetData","get","err","handleSignUpAndSignIn","data","defaults","common","setItem","decoded","user","email","logout","removeItem","currentTime","Date","now","exp"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport uuidv4 from 'uuid/v4';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\n\nimport './App.css';\n\nimport Nav from './Components/Nav';\nimport Task from './Components/Task';\nimport Input from './Components/Input';\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tasks: [],\n      user: null\n    }\n\n  } \n\n  componentDidMount() {\n\n    var token = localStorage.getItem('jwtToken');\n\n    if (token) {\n\n      const currentTime = Date.now() / 1000;\n      const decoded = jwt_decode(token);\n\n      if (decoded.exp < currentTime) {\n        localStorage.removeItem('jwtToken');\n        this.setState({\n          user: null\n        })\n      }\n      axios.defaults.headers.common['Authorization'] = token;\n\n      this.setState({\n        user: decoded.email\n      }, () => {\n        this.handleGetData()\n      })\n    }\n\n  }\n\n\n  handleChecked = (id) => {\n\n    let updatedTasks = this.state.tasks.map( (todo) => {\n      if (todo.id === id) {\n        todo.completed = !todo.completed      \n      }\n      return todo;\n    })\n    this.setState({\n      task: updatedTasks\n    })\n  }\n\n  handleAddTask = (task) => {\n    var token = localStorage.getItem('jwtToken');\n    let newTask = {\n      todo: task,\n      completed: false,\n      id: token._id\n    }\n\n    let axiosConfig = {\n      headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\",\n      }\n    };\n\n    axios.post('http://localhost:3001/todo/createtodo', newTask, axiosConfig)\n      .then(result => {\n        console.log(result)\n        let currentTaskObj = Object.assign([], this.state.tasks);\n        currentTaskObj.push(newTask);\n        this.setState({\n          tasks: result\n        })\n      })\n      .catch(error => {\n        console.log(error)\n      })\n\n  }\n\n  handleUpdateEdit = (id, updatedTask) => {\n    let updated = Object.assign([], this.state.tasks);\n\n    updated.map((task) =>\n      (task.id === id ? task.todo = updatedTask : task) \n    );\n    \n    this.setState({\n      tasks: updated\n    })\n\n  }\n\n  handleDelete = (id) => {\n    let updated = Object.assign([], this.state.tasks);\n \n    let updatedList = updated.filter((task) => \n      task.id !== id  \n    );\n\n   this.setState({\n     tasks: updatedList\n   })\n\n  }\n\n  handleGetData = () => {\n    axios.get('http://localhost:3001/users/current')\n    .then(result => {\n      console.log(result)\n    })\n    .catch(err => {\n      console.log(err)\n    })\n  }\n\n  handleSignUpAndSignIn = (data) => {\n\n    let axiosConfig = {\n      headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\",\n      }\n    };\n\n    axios.post('http://localhost:3001/users/register-login', data, axiosConfig)\n      .then(result => {\n\n\n        const { token } = result.data;\n        axios.defaults.headers.common['Authorization'] = token;\n        // Set token to ls\n        localStorage.setItem('jwtToken', token);\n        // Set token to Auth header\n\n        // Decode token to get user data\n        const decoded = jwt_decode(token);\n\n        this.setState({\n          user: decoded.email\n        }, () => {\n          this.handleGetData()\n        })\n\n      })\n      .catch(err => {\n        console.log(err)\n      })\n  }\n\n  logout = () => {\n    delete axios.defaults.headers.common['Authorization'];\n    localStorage.removeItem('jwtToken');\n    this.setState({\n      user: null\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Nav \n          handleSignUpAndSignIn={this.handleSignUpAndSignIn} \n          user={this.state.user}\n          logout={this.logout}\n          />\n        <Input handleAddTask={this.handleAddTask} />\n        <Task {...this.state} \n              handleChecked={this.handleChecked} \n              handleUpdateEdit={this.handleUpdateEdit}  \n              handleDelete={this.handleDelete}\n              />\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _classCallCheck from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/src/App.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport './App.css';\nimport Nav from './Components/Nav';\nimport Task from './Components/Task';\nimport Input from './Components/Input';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.handleChecked = function (id) {\n      var updatedTasks = _this.state.tasks.map(function (todo) {\n        if (todo._id === id) {\n          todo.completed = !todo.completed;\n        }\n\n        return todo;\n      });\n\n      _this.setState({\n        task: updatedTasks\n      });\n    };\n\n    _this.handleAddTask = function (task) {\n      var token = localStorage.getItem('jwtToken');\n      var decoded = jwt_decode(token);\n      var newTask = {\n        todo: task,\n        completed: false,\n        id: decoded.id\n      };\n      var axiosConfig = {\n        headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\"\n        }\n      };\n      axios.post('http://localhost:3001/todo/createtodo', newTask, axiosConfig).then(function (result) {\n        var currentTaskObj = Object.assign([], _this.state.tasks);\n        currentTaskObj.push(result.data);\n\n        _this.setState({\n          tasks: currentTaskObj\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    _this.handleUpdateEdit = function (id, updatedTask) {\n      var updated = Object.assign([], _this.state.tasks);\n      updated.map(function (task) {\n        return task._id === id ? task.todo = updatedTask : task;\n      });\n\n      _this.setState({\n        tasks: updated\n      });\n    };\n\n    _this.handleDelete = function (id) {\n      //let updated = Object.assign([], this.state.tasks);\n      // let updatedList = updated.filter((task) => \n      //   task._id !== id  \n      // );\n      var token = localStorage.getItem('jwtToken');\n      var decoded = jwt_decode(token);\n      axios.delete(\"http://localhost:3001/todo/deletetodo/\".concat(decoded.id, \"?todoid=\").concat(id, \"&_method=DELETE\")).then(function (user) {\n        _this.setState({\n          tasks: user.data.todos\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.handleGetData = function () {\n      var token = localStorage.getItem('jwtToken');\n      var decoded = jwt_decode(token);\n      axios.get(\"http://localhost:3001/todo/getalltodos/\".concat(decoded.id)).then(function (result) {\n        _this.setState({\n          tasks: result.data.todos\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.handleSignUpAndSignIn = function (data) {\n      var axiosConfig = {\n        headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\"\n        }\n      };\n      axios.post('http://localhost:3001/users/register-login', data, axiosConfig).then(function (result) {\n        var token = result.data.token;\n        axios.defaults.headers.common['Authorization'] = token; // Set token to ls\n\n        localStorage.setItem('jwtToken', token); // Set token to Auth header\n        // Decode token to get user data\n\n        var decoded = jwt_decode(token);\n\n        _this.setState({\n          user: decoded.email\n        }, function () {\n          _this.handleGetData();\n        });\n      }).catch(function (err) {\n        console.log(JSON.stringify(err.response.data.payload));\n      });\n    };\n\n    _this.logout = function () {\n      delete axios.defaults.headers.common['Authorization'];\n      localStorage.removeItem('jwtToken');\n\n      _this.setState({\n        user: null\n      });\n    };\n\n    _this.state = {\n      tasks: [],\n      user: null,\n      error: false,\n      errorMessage: ''\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      try {\n        var token = localStorage.getItem('jwtToken');\n\n        if (token) {\n          var currentTime = Date.now() / 1000;\n          var decoded = jwt_decode(token);\n\n          if (decoded.exp < currentTime) {\n            localStorage.removeItem('jwtToken');\n            this.setState({\n              user: null\n            });\n          }\n\n          axios.defaults.headers.common['Authorization'] = token;\n          this.setState({\n            user: decoded.email\n          }, function () {\n            _this2.handleGetData();\n          });\n        }\n      } catch (err) {\n        return;\n      }\n\n      if (token === null || token === undefined) {\n        return;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(Nav, {\n        handleSignUpAndSignIn: this.handleSignUpAndSignIn,\n        user: this.state.user,\n        logout: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }), React.createElement(Input, {\n        handleAddTask: this.handleAddTask,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }), React.createElement(Task, Object.assign({}, this.state, {\n        handleChecked: this.handleChecked,\n        handleUpdateEdit: this.handleUpdateEdit,\n        handleDelete: this.handleDelete,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/pakchu/Desktop/React-Term-3/react/frontend-backend/client/src/App.js"],"names":["React","Component","axios","jwt_decode","Nav","Task","Input","App","props","handleChecked","id","updatedTasks","state","tasks","map","todo","_id","completed","setState","task","handleAddTask","token","localStorage","getItem","decoded","newTask","axiosConfig","headers","post","then","result","currentTaskObj","Object","assign","push","data","catch","error","console","log","handleUpdateEdit","updatedTask","updated","handleDelete","delete","user","todos","err","handleGetData","get","handleSignUpAndSignIn","defaults","common","setItem","email","JSON","stringify","response","payload","logout","removeItem","errorMessage","currentTime","Date","now","exp","undefined"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA,OAAO,WAAP;AAEA,OAAOC,GAAP,MAAgB,kBAAhB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;;IAEMC,G;;;;;AAEJ,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,6EAAMA,KAAN;;AADiB,UAqDnBC,aArDmB,GAqDH,UAACC,EAAD,EAAQ;AAEtB,UAAIC,YAAY,GAAG,MAAKC,KAAL,CAAWC,KAAX,CAAiBC,GAAjB,CAAsB,UAACC,IAAD,EAAU;AACjD,YAAIA,IAAI,CAACC,GAAL,KAAaN,EAAjB,EAAqB;AACnBK,UAAAA,IAAI,CAACE,SAAL,GAAiB,CAACF,IAAI,CAACE,SAAvB;AACD;;AACD,eAAOF,IAAP;AACD,OALkB,CAAnB;;AAMA,YAAKG,QAAL,CAAc;AACZC,QAAAA,IAAI,EAAER;AADM,OAAd;AAGD,KAhEkB;;AAAA,UAkEnBS,aAlEmB,GAkEH,UAACD,IAAD,EAAU;AACxB,UAAIE,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAZ;AACA,UAAMC,OAAO,GAAGrB,UAAU,CAACkB,KAAD,CAA1B;AACA,UAAII,OAAO,GAAG;AACZV,QAAAA,IAAI,EAAEI,IADM;AAEZF,QAAAA,SAAS,EAAE,KAFC;AAGZP,QAAAA,EAAE,EAAEc,OAAO,CAACd;AAHA,OAAd;AAMA,UAAIgB,WAAW,GAAG;AAChBC,QAAAA,OAAO,EAAE;AACL,0BAAgB,gCADX;AAEL,yCAA+B;AAF1B;AADO,OAAlB;AAOAzB,MAAAA,KAAK,CAAC0B,IAAN,CAAW,uCAAX,EAAoDH,OAApD,EAA6DC,WAA7D,EACGG,IADH,CACQ,UAAAC,MAAM,EAAI;AACd,YAAIC,cAAc,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,MAAKrB,KAAL,CAAWC,KAA7B,CAArB;AACAkB,QAAAA,cAAc,CAACG,IAAf,CAAoBJ,MAAM,CAACK,IAA3B;;AACA,cAAKjB,QAAL,CAAc;AACZL,UAAAA,KAAK,EAAEkB;AADK,SAAd;AAGD,OAPH,EAQGK,KARH,CAQS,UAAAC,KAAK,EAAI;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD,OAVH;AAYD,KA9FkB;;AAAA,UAgGnBG,gBAhGmB,GAgGA,UAAC9B,EAAD,EAAK+B,WAAL,EAAqB;AACtC,UAAIC,OAAO,GAAGV,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,MAAKrB,KAAL,CAAWC,KAA7B,CAAd;AACA6B,MAAAA,OAAO,CAAC5B,GAAR,CAAY,UAACK,IAAD;AAAA,eACTA,IAAI,CAACH,GAAL,KAAaN,EAAb,GAAkBS,IAAI,CAACJ,IAAL,GAAY0B,WAA9B,GAA4CtB,IADnC;AAAA,OAAZ;;AAIA,YAAKD,QAAL,CAAc;AACZL,QAAAA,KAAK,EAAE6B;AADK,OAAd;AAID,KA1GkB;;AAAA,UA4GnBC,YA5GmB,GA4GJ,UAACjC,EAAD,EAAQ;AACrB;AAEA;AACA;AACA;AAEA,UAAIW,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAZ;AACA,UAAMC,OAAO,GAAGrB,UAAU,CAACkB,KAAD,CAA1B;AAEAnB,MAAAA,KAAK,CAAC0C,MAAN,iDAAsDpB,OAAO,CAACd,EAA9D,qBAA2EA,EAA3E,sBACGmB,IADH,CACQ,UAAAgB,IAAI,EAAI;AACZ,cAAK3B,QAAL,CAAc;AACZL,UAAAA,KAAK,EAAEgC,IAAI,CAACV,IAAL,CAAUW;AADL,SAAd;AAGD,OALH,EAMGV,KANH,CAMS,UAAAW,GAAG,EAAI;AACZT,QAAAA,OAAO,CAACC,GAAR,CAAYQ,GAAZ;AACD,OARH;AASD,KA/HkB;;AAAA,UAiInBC,aAjImB,GAiIH,YAAM;AAEpB,UAAI3B,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAZ;AACA,UAAMC,OAAO,GAAGrB,UAAU,CAACkB,KAAD,CAA1B;AAEAnB,MAAAA,KAAK,CAAC+C,GAAN,kDAAoDzB,OAAO,CAACd,EAA5D,GACCmB,IADD,CACM,UAAAC,MAAM,EAAI;AACd,cAAKZ,QAAL,CAAc;AACZL,UAAAA,KAAK,EAAEiB,MAAM,CAACK,IAAP,CAAYW;AADP,SAAd;AAGD,OALD,EAMCV,KAND,CAMO,UAAAW,GAAG,EAAI;AACZT,QAAAA,OAAO,CAACC,GAAR,CAAYQ,GAAZ;AACD,OARD;AASD,KA/IkB;;AAAA,UAiJnBG,qBAjJmB,GAiJK,UAACf,IAAD,EAAU;AAEhC,UAAIT,WAAW,GAAG;AAChBC,QAAAA,OAAO,EAAE;AACL,0BAAgB,gCADX;AAEL,yCAA+B;AAF1B;AADO,OAAlB;AAOAzB,MAAAA,KAAK,CAAC0B,IAAN,CAAW,4CAAX,EAAyDO,IAAzD,EAA+DT,WAA/D,EACGG,IADH,CACQ,UAAAC,MAAM,EAAI;AAAA,YAGNT,KAHM,GAGIS,MAAM,CAACK,IAHX,CAGNd,KAHM;AAIdnB,QAAAA,KAAK,CAACiD,QAAN,CAAexB,OAAf,CAAuByB,MAAvB,CAA8B,eAA9B,IAAiD/B,KAAjD,CAJc,CAKd;;AACAC,QAAAA,YAAY,CAAC+B,OAAb,CAAqB,UAArB,EAAiChC,KAAjC,EANc,CAOd;AAEA;;AACA,YAAMG,OAAO,GAAGrB,UAAU,CAACkB,KAAD,CAA1B;;AAEA,cAAKH,QAAL,CAAc;AACZ2B,UAAAA,IAAI,EAAErB,OAAO,CAAC8B;AADF,SAAd,EAEG,YAAM;AACP,gBAAKN,aAAL;AACD,SAJD;AAMD,OAnBH,EAoBGZ,KApBH,CAoBS,UAAAW,GAAG,EAAI;AACZT,QAAAA,OAAO,CAACC,GAAR,CAAYgB,IAAI,CAACC,SAAL,CAAeT,GAAG,CAACU,QAAJ,CAAatB,IAAb,CAAkBuB,OAAjC,CAAZ;AACD,OAtBH;AAuBD,KAjLkB;;AAAA,UAmLnBC,MAnLmB,GAmLV,YAAM;AACb,aAAOzD,KAAK,CAACiD,QAAN,CAAexB,OAAf,CAAuByB,MAAvB,CAA8B,eAA9B,CAAP;AACA9B,MAAAA,YAAY,CAACsC,UAAb,CAAwB,UAAxB;;AACA,YAAK1C,QAAL,CAAc;AACZ2B,QAAAA,IAAI,EAAE;AADM,OAAd;AAGD,KAzLkB;;AAGjB,UAAKjC,KAAL,GAAa;AACXC,MAAAA,KAAK,EAAE,EADI;AAEXgC,MAAAA,IAAI,EAAE,IAFK;AAGXR,MAAAA,KAAK,EAAE,KAHI;AAIXwB,MAAAA,YAAY,EAAE;AAJH,KAAb;AAHiB;AAUlB;;;;wCAEmB;AAAA;;AAGlB,UAAI;AACF,YAAIxC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAZ;;AAEA,YAAIF,KAAJ,EAAW;AAET,cAAMyC,WAAW,GAAGC,IAAI,CAACC,GAAL,KAAa,IAAjC;AACA,cAAMxC,OAAO,GAAGrB,UAAU,CAACkB,KAAD,CAA1B;;AAEA,cAAIG,OAAO,CAACyC,GAAR,GAAcH,WAAlB,EAA+B;AAC7BxC,YAAAA,YAAY,CAACsC,UAAb,CAAwB,UAAxB;AACA,iBAAK1C,QAAL,CAAc;AACZ2B,cAAAA,IAAI,EAAE;AADM,aAAd;AAGD;;AACD3C,UAAAA,KAAK,CAACiD,QAAN,CAAexB,OAAf,CAAuByB,MAAvB,CAA8B,eAA9B,IAAiD/B,KAAjD;AAEA,eAAKH,QAAL,CAAc;AACZ2B,YAAAA,IAAI,EAAErB,OAAO,CAAC8B;AADF,WAAd,EAEG,YAAM;AACP,YAAA,MAAI,CAACN,aAAL;AACD,WAJD;AAKD;AAEF,OAvBD,CAuBE,OAAOD,GAAP,EAAY;AACZ;AACD;;AAID,UAAI1B,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK6C,SAAhC,EAA2C;AACzC;AACD;AAIF;;;6BAyIQ;AACP,aACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,GAAD;AACE,QAAA,qBAAqB,EAAE,KAAKhB,qBAD9B;AAEE,QAAA,IAAI,EAAE,KAAKtC,KAAL,CAAWiC,IAFnB;AAGE,QAAA,MAAM,EAAE,KAAKc,MAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAME,oBAAC,KAAD;AAAO,QAAA,aAAa,EAAE,KAAKvC,aAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QANF,EAOE,oBAAC,IAAD,oBAAU,KAAKR,KAAf;AACM,QAAA,aAAa,EAAE,KAAKH,aAD1B;AAEM,QAAA,gBAAgB,EAAE,KAAK+B,gBAF7B;AAGM,QAAA,YAAY,EAAE,KAAKG,YAHzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAPF,CADF;AAeD;;;;EA7Me1C,S;;AAgNlB,eAAeM,GAAf","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\n\nimport './App.css';\n\nimport Nav from './Components/Nav';\nimport Task from './Components/Task';\nimport Input from './Components/Input';\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tasks: [],\n      user: null,\n      error: false,\n      errorMessage: ''\n    }\n\n  } \n\n  componentDidMount() {\n    \n\n    try {\n      var token = localStorage.getItem('jwtToken');\n\n      if (token) {\n\n        const currentTime = Date.now() / 1000;\n        const decoded = jwt_decode(token);\n  \n        if (decoded.exp < currentTime) {\n          localStorage.removeItem('jwtToken');\n          this.setState({\n            user: null\n          })\n        }\n        axios.defaults.headers.common['Authorization'] = token;\n  \n        this.setState({\n          user: decoded.email\n        }, () => {\n          this.handleGetData()\n        })\n      }\n\n    } catch (err) {\n      return;\n    }\n\n\n\n    if (token === null || token === undefined) {\n      return\n    }\n\n\n\n  }\n\n\n  handleChecked = (id) => {\n\n    let updatedTasks = this.state.tasks.map( (todo) => {\n      if (todo._id === id) {\n        todo.completed = !todo.completed      \n      }\n      return todo;\n    })\n    this.setState({\n      task: updatedTasks\n    })\n  }\n\n  handleAddTask = (task) => {\n    var token = localStorage.getItem('jwtToken');\n    const decoded = jwt_decode(token);\n    let newTask = {\n      todo: task,\n      completed: false,\n      id: decoded.id\n    }\n\n    let axiosConfig = {\n      headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\",\n      }\n    };\n\n    axios.post('http://localhost:3001/todo/createtodo', newTask, axiosConfig)\n      .then(result => {\n        let currentTaskObj = Object.assign([], this.state.tasks);\n        currentTaskObj.push(result.data);\n        this.setState({\n          tasks: currentTaskObj\n        })\n      })\n      .catch(error => {\n        console.log(error)\n      })\n\n  }\n\n  handleUpdateEdit = (id, updatedTask) => {\n    let updated = Object.assign([], this.state.tasks);\n    updated.map((task) =>\n      (task._id === id ? task.todo = updatedTask : task) \n    );\n\n    this.setState({\n      tasks: updated\n    })\n\n  }\n\n  handleDelete = (id) => {\n    //let updated = Object.assign([], this.state.tasks);\n \n    // let updatedList = updated.filter((task) => \n    //   task._id !== id  \n    // );\n\n    var token = localStorage.getItem('jwtToken');\n    const decoded = jwt_decode(token);\n\n    axios.delete(`http://localhost:3001/todo/deletetodo/${decoded.id}?todoid=${id}&_method=DELETE`)\n      .then(user => {\n        this.setState({\n          tasks: user.data.todos\n        })\n      })\n      .catch(err => {\n        console.log(err)\n      })\n  }\n\n  handleGetData = () => {\n\n    var token = localStorage.getItem('jwtToken');\n    const decoded = jwt_decode(token);\n\n    axios.get(`http://localhost:3001/todo/getalltodos/${decoded.id}`)\n    .then(result => {\n      this.setState({\n        tasks: result.data.todos\n      })\n    })\n    .catch(err => {\n      console.log(err)\n    })\n  }\n\n  handleSignUpAndSignIn = (data) => {\n\n    let axiosConfig = {\n      headers: {\n          'Content-Type': 'application/json;charset=UTF-8',\n          \"Access-Control-Allow-Origin\": \"*\",\n      }\n    };\n\n    axios.post('http://localhost:3001/users/register-login', data, axiosConfig)\n      .then(result => {\n\n\n        const { token } = result.data;\n        axios.defaults.headers.common['Authorization'] = token;\n        // Set token to ls\n        localStorage.setItem('jwtToken', token);\n        // Set token to Auth header\n\n        // Decode token to get user data\n        const decoded = jwt_decode(token);\n\n        this.setState({\n          user: decoded.email\n        }, () => {\n          this.handleGetData()\n        })\n\n      })\n      .catch(err => {\n        console.log(JSON.stringify(err.response.data.payload))\n      })\n  }\n\n  logout = () => {\n    delete axios.defaults.headers.common['Authorization'];\n    localStorage.removeItem('jwtToken');\n    this.setState({\n      user: null\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Nav \n          handleSignUpAndSignIn={this.handleSignUpAndSignIn} \n          user={this.state.user}\n          logout={this.logout}\n          />\n        <Input handleAddTask={this.handleAddTask} />\n        <Task {...this.state} \n              handleChecked={this.handleChecked} \n              handleUpdateEdit={this.handleUpdateEdit}  \n              handleDelete={this.handleDelete}\n              />\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}